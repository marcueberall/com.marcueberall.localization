#region Directives

using System;
using System.Collections;
using System.Collections.Generic;
using System.Xml.Linq;
using System.Linq;
using System.Text;
using System.Data;
using System.IO;

using ExcelDataReader;

using UnityEngine;
using UnityEditor;

#endregion

/// <copyright>
///
///
///    ███▄ ▄███▓ ▄▄▄       ██▀███   ▄████▄      █    ██ ▓█████  ▄▄▄▄   ▓█████  ██▀███   ▄▄▄       ██▓     ██▓    
///   ▓██▒▀█▀ ██▒▒████▄    ▓██ ▒ ██▒▒██▀ ▀█      ██  ▓██▒▓█   ▀ ▓█████▄ ▓█   ▀ ▓██ ▒ ██▒▒████▄    ▓██▒    ▓██▒    
///   ▓██    ▓██░▒██  ▀█▄  ▓██ ░▄█ ▒▒▓█    ▄    ▓██  ▒██░▒███   ▒██▒ ▄██▒███   ▓██ ░▄█ ▒▒██  ▀█▄  ▒██░    ▒██░    
///   ▒██    ▒██ ░██▄▄▄▄██ ▒██▀▀█▄  ▒▓▓▄ ▄██▒   ▓▓█  ░██░▒▓█  ▄ ▒██░█▀  ▒▓█  ▄ ▒██▀▀█▄  ░██▄▄▄▄██ ▒██░    ▒██░    
///   ▒██▒   ░██▒ ▓█   ▓██▒░██▓ ▒██▒▒ ▓███▀ ░   ▒▒█████▓ ░▒████▒░▓█  ▀█▓░▒████▒░██▓ ▒██▒ ▓█   ▓██▒░██████▒░██████▒
///   ░ ▒░   ░  ░ ▒▒   ▓▒█░░ ▒▓ ░▒▓░░ ░▒ ▒  ░   ░▒▓▒ ▒ ▒ ░░ ▒░ ░░▒▓███▀▒░░ ▒░ ░░ ▒▓ ░▒▓░ ▒▒   ▓▒█░░ ▒░▓  ░░ ▒░▓  ░
///   ░  ░      ░  ▒   ▒▒ ░  ░▒ ░ ▒░  ░  ▒      ░░▒░ ░ ░  ░ ░  ░▒░▒   ░  ░ ░  ░  ░▒ ░ ▒░  ▒   ▒▒ ░░ ░ ▒  ░░ ░ ▒  ░
///   ░      ░     ░   ▒     ░░   ░ ░            ░░░ ░ ░    ░    ░    ░    ░     ░░   ░   ░   ▒     ░ ░     ░ ░   
///          ░         ░  ░   ░     ░ ░            ░        ░  ░ ░         ░  ░   ░           ░  ░    ░  ░    ░  ░
///                                 ░                                 ░                                           
///	
/// </copyright>
namespace com.marcueberall.localization {
	[CustomEditor(typeof(LocalizationManager))]
	public class LocalizationManagerEditor : Editor {
		#region Constants

		protected const string LOCALIZATION_SHEET = @"Localization.xlsx";

		#endregion

		#region Fields

		protected SerializedProperty m_defaultLanguage = null;
		protected SerializedProperty m_onChangeLanguage = null;

		#endregion

		#region Properties

		public static string localizationDataPath {
			get => $"{Application.dataPath.Replace(@"Assets", LocalizationManager.LOCALIZATION_PATH)}";
		}

		public static string localizationSheet {
			get => $"{LocalizationManagerEditor.localizationDataPath}/{LocalizationManagerEditor.LOCALIZATION_SHEET}";
		}

		public static string localizationResourcesPath {
			get => $"{Application.dataPath}/Resources/{LocalizationManager.LOCALIZATION_PATH}";
		}

		#endregion

		#region Methods

		protected virtual void CreateLocalizationSheet() {
			if (File.Exists(LocalizationManagerEditor.localizationSheet)) {
				if (!EditorUtility.DisplayDialog(@"Localization Manager", @"There is already a localization sheet in the target directory. Do you want to overwrite the existing one?",
					@"Yes", @"No")) {
					return;
				}
			}

			this.WriteLocalizationSheet();

			System.Diagnostics.Process.Start($"file://{LocalizationManagerEditor.localizationSheet}");
		}

		protected virtual void EditLocalizationSheet() {
			if (!File.Exists(LocalizationManagerEditor.localizationSheet)) {
				if (EditorUtility.DisplayDialog(@"Localization Manager", @"Either the target directory of the localization sheet itself does not exist. Do you want to create a new one now?",
					@"Yes", @"No")) {
					this.WriteLocalizationSheet();
				}
				else {
					return;
				}
			}

			System.Diagnostics.Process.Start($"file://{LocalizationManagerEditor.localizationSheet}");
		}

		protected virtual void GenerateLocalizationData(LocalizationManager target) {
			if (!File.Exists(LocalizationManagerEditor.localizationSheet)) {
				if (EditorUtility.DisplayDialog(@"Localization Manager", @"Either the target directory or the localization sheet itself does not exist. Do you want to create a new one now?",
					@"Yes", @"No")) {
					this.WriteLocalizationSheet();
				}
				else {
					return;
				}
			}

			try {
				using (var reader = ExcelReaderFactory.CreateOpenXmlReader(File.OpenRead(LocalizationManagerEditor.localizationSheet))) {
					DataSet dataSet = reader.AsDataSet();
					DataTable table = dataSet.Tables[0];
					List<string> keys = new List<string>();
					List<string> languages = new List<string>();
					Dictionary<int, List<string>> data = new Dictionary<int, List<string>>();

					int cells = table.Rows[0].ItemArray.Length;

					for (int l = 1; l < cells; l++) {
						languages.Add(table.Rows[0].ItemArray[l] as string);
						data.Add(l - 1, new List<string>());
					}

					for (int r = 1; r < table.Rows.Count; r++) {
						keys.Add(table.Rows[r].ItemArray[0] as string);

						for (int c = 1; c < cells; c++) {
							data[c - 1].Add(table.Rows[r].ItemArray[c] as string);
						}
					}

					if (!Directory.Exists(LocalizationManagerEditor.localizationResourcesPath)) {
						Directory.CreateDirectory(LocalizationManagerEditor.localizationResourcesPath);
					}

					for (int l = 0; l < languages.Count; l++) {
						if (!string.IsNullOrEmpty(languages[l])) {
							XDocument doc = new XDocument();

							XElement root = new XElement(LocalizationManager.XML_TAG_LANGUAGE, new XAttribute(LocalizationManager.XML_ATTRIBUTE_ID, languages[l]));

							for (int r = 0; r < keys.Count; r++) {
								root.Add(new XElement(LocalizationManager.XML_TAG_DATA, new XAttribute(LocalizationManager.XML_ATTRIBUTE_ID, keys[r]), data[l][r]));
							}

							doc.Add(root);
							doc.Save($"{LocalizationManagerEditor.localizationResourcesPath}/{languages[l]}.xml");
						}
					}

					target.supportedLanguages = languages.ToArray();
				}
			}
			catch (Exception e) {
				Debug.LogError($"Failed to load localization file '{LocalizationManagerEditor.localizationDataPath}': {e.ToString()}.");
			}
		}

		protected virtual void WriteLocalizationSheet() {
			if (!Directory.Exists(LocalizationManagerEditor.localizationDataPath)) {
				Directory.CreateDirectory(LocalizationManagerEditor.localizationDataPath);
			}

			File.WriteAllBytes(LocalizationManagerEditor.localizationSheet, new byte[] {
				80, 75, 3, 4, 20, 0, 8, 8, 8, 0, 125, 60, 7, 79, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 11, 0, 0, 0, 95, 114, 101, 108, 115, 47, 46, 114, 101, 108, 115, 173, 146, 207, 74, 3, 49, 16, 135,
				239, 125, 138, 144, 123, 119, 182, 21, 68, 100, 179, 189, 136, 208, 155, 72, 125, 128, 152, 204, 254, 97, 55, 153, 48, 25, 117, 125, 123, 131, 8, 90, 169, 165, 7, 143, 73, 126, 243,
				205, 55, 67, 154, 221, 18, 102, 245, 138, 156, 71, 138, 70, 111, 170, 90, 43, 140, 142, 252, 24, 123, 163, 159, 14, 247, 235, 27, 189, 107, 87, 205, 35, 206, 86, 74, 36, 15, 99, 202,
				170, 212, 196, 108, 244, 32, 146, 110, 1, 178, 27, 48, 216, 92, 81, 194, 88, 94, 58, 226, 96, 165, 28, 185, 135, 100, 221, 100, 123, 132, 109, 93, 95, 3, 255, 100, 232, 246, 136, 169,
				246, 222, 104, 222, 251, 141, 86, 135, 247, 132, 151, 176, 169, 235, 70, 135, 119, 228, 94, 2, 70, 57, 209, 226, 87, 162, 144, 45, 247, 40, 70, 47, 51, 188, 17, 79, 207, 68, 83, 85,
				160, 26, 78, 187, 108, 47, 119, 249, 123, 78, 8, 40, 214, 91, 177, 224, 136, 113, 157, 184, 84, 179, 140, 152, 191, 117, 60, 185, 135, 114, 157, 63, 19, 231, 132, 174, 254, 115, 57,
				184, 8, 70, 143, 254, 188, 146, 77, 233, 203, 104, 213, 192, 209, 39, 104, 63, 0, 80, 75, 7, 8, 102, 170, 130, 183, 224, 0, 0, 0, 59, 2, 0, 0, 80, 75, 3, 4, 20, 0, 8, 8, 8, 0, 125, 60,
				7, 79, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 17, 0, 0, 0, 100, 111, 99, 80, 114, 111, 112, 115, 47, 99, 111, 114, 101, 46, 120, 109, 108, 141, 82, 203, 78, 195, 48, 16, 188, 243, 21, 145,
				239, 137, 157, 20, 1, 141, 210, 84, 60, 212, 19, 149, 144, 218, 10, 196, 205, 181, 183, 173, 193, 113, 44, 219, 125, 125, 18, 223, 193, 143, 225, 164, 173, 41, 180, 72, 220, 118, 119,
				198, 179, 59, 222, 45, 250, 155, 74, 70, 43, 48, 86, 212, 170, 135, 210, 132, 160, 8, 20, 171, 185, 80, 243, 30, 154, 140, 7, 241, 13, 138, 172, 163, 138, 83, 89, 43, 232, 161, 45, 88,
				212, 47, 47, 10, 166, 115, 86, 27, 120, 50, 181, 6, 227, 4, 216, 200, 11, 41, 155, 51, 221, 67, 11, 231, 116, 142, 177, 101, 11, 168, 168, 77, 60, 67, 121, 112, 86, 155, 138, 58, 159,
				154, 57, 214, 148, 189, 211, 57, 224, 140, 144, 43, 92, 129, 163, 156, 58, 138, 27, 193, 88, 7, 69, 180, 151, 228, 44, 72, 234, 165, 145, 173, 0, 103, 24, 36, 84, 160, 156, 197, 105,
				146, 226, 111, 174, 3, 83, 217, 179, 15, 90, 228, 136, 89, 9, 183, 213, 112, 150, 122, 0, 3, 123, 99, 69, 32, 174, 215, 235, 100, 221, 105, 169, 126, 254, 20, 191, 12, 31, 71, 173, 213,
				88, 168, 230, 171, 24, 160, 178, 216, 15, 146, 51, 3, 212, 1, 143, 188, 64, 190, 107, 119, 64, 158, 59, 247, 15, 227, 1, 42, 51, 146, 118, 99, 114, 19, 147, 235, 49, 233, 230, 228, 50,
				79, 201, 107, 129, 127, 189, 111, 4, 119, 113, 109, 202, 33, 53, 44, 186, 85, 220, 124, 126, 68, 19, 152, 130, 161, 82, 54, 47, 2, 161, 33, 115, 176, 204, 8, 237, 252, 94, 203, 22, 252,
				81, 240, 185, 164, 106, 190, 244, 75, 40, 65, 197, 147, 81, 75, 9, 165, 102, 189, 146, 90, 55, 244, 135, 48, 19, 192, 239, 182, 127, 52, 61, 229, 5, 231, 213, 190, 246, 111, 235, 89,
				150, 147, 238, 145, 245, 131, 64, 59, 141, 129, 149, 104, 110, 180, 204, 218, 166, 33, 109, 156, 216, 229, 244, 13, 152, 219, 217, 12, 137, 143, 157, 112, 18, 118, 229, 67, 120, 114,
				183, 229, 23, 80, 75, 7, 8, 251, 89, 193, 235, 120, 1, 0, 0, 3, 3, 0, 0, 80, 75, 3, 4, 20, 0, 8, 8, 8, 0, 125, 60, 7, 79, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16, 0, 0, 0, 100, 111, 99,
				80, 114, 111, 112, 115, 47, 97, 112, 112, 46, 120, 109, 108, 157, 144, 49, 79, 195, 48, 16, 133, 119, 126, 69, 100, 177, 54, 78, 76, 28, 66, 229, 184, 66, 66, 76, 72, 48, 4, 202, 22,
				185, 246, 185, 53, 74, 108, 203, 54, 165, 253, 247, 24, 144, 218, 206, 108, 247, 238, 157, 190, 119, 119, 108, 117, 152, 167, 98, 15, 33, 26, 103, 123, 84, 151, 21, 42, 192, 74, 167,
				140, 221, 246, 232, 117, 120, 92, 116, 168, 136, 73, 88, 37, 38, 103, 161, 71, 71, 136, 104, 197, 175, 216, 75, 112, 30, 66, 50, 16, 139, 76, 176, 177, 71, 187, 148, 252, 18, 227, 40,
				119, 48, 139, 88, 102, 219, 102, 71, 187, 48, 139, 148, 101, 216, 98, 167, 181, 145, 240, 224, 228, 231, 12, 54, 97, 82, 85, 45, 134, 67, 2, 171, 64, 45, 252, 9, 136, 254, 136, 203,
				125, 250, 47, 84, 57, 249, 179, 95, 124, 27, 142, 62, 243, 56, 27, 96, 246, 147, 72, 192, 25, 62, 151, 131, 75, 98, 26, 204, 12, 252, 54, 183, 79, 130, 221, 123, 63, 25, 41, 82, 254,
				8, 127, 50, 155, 0, 207, 191, 17, 184, 45, 73, 73, 75, 114, 189, 54, 86, 185, 175, 56, 190, 119, 237, 216, 54, 197, 197, 200, 152, 143, 248, 0, 153, 112, 13, 242, 166, 110, 180, 160,
				68, 55, 180, 19, 74, 214, 157, 108, 116, 69, 168, 164, 13, 21, 13, 116, 27, 66, 100, 77, 239, 24, 190, 12, 99, 248, 252, 85, 254, 13, 80, 75, 7, 8, 252, 113, 90, 30, 2, 1, 0, 0, 154,
				1, 0, 0, 80, 75, 3, 4, 20, 0, 8, 8, 8, 0, 125, 60, 7, 79, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 24, 0, 0, 0, 120, 108, 47, 119, 111, 114, 107, 115, 104, 101, 101, 116, 115, 47, 115, 104,
				101, 101, 116, 49, 46, 120, 109, 108, 157, 85, 81, 111, 219, 54, 16, 126, 223, 175, 32, 244, 208, 167, 205, 178, 189, 185, 41, 82, 89, 69, 234, 204, 107, 129, 52, 14, 226, 180, 5, 246,
				70, 139, 39, 139, 8, 197, 83, 73, 202, 110, 242, 235, 119, 36, 37, 89, 115, 138, 161, 152, 31, 108, 242, 120, 252, 238, 187, 239, 120, 231, 236, 221, 247, 90, 177, 3, 24, 43, 81, 47,
				147, 217, 100, 154, 48, 208, 5, 10, 169, 247, 203, 228, 243, 195, 250, 183, 55, 9, 179, 142, 107, 193, 21, 106, 88, 38, 79, 96, 147, 119, 249, 47, 217, 17, 205, 163, 173, 0, 28, 35, 0,
				109, 151, 73, 229, 92, 115, 153, 166, 182, 168, 160, 230, 118, 130, 13, 104, 58, 41, 209, 212, 220, 209, 214, 236, 83, 219, 24, 224, 34, 92, 170, 85, 58, 159, 78, 95, 167, 53, 151, 58,
				137, 8, 151, 230, 103, 48, 176, 44, 101, 1, 215, 88, 180, 53, 104, 23, 65, 12, 40, 238, 136, 190, 173, 100, 99, 147, 60, 11, 17, 238, 12, 43, 165, 114, 96, 62, 161, 32, 218, 37, 87,
				22, 232, 172, 225, 123, 216, 130, 251, 220, 132, 115, 247, 128, 119, 100, 232, 143, 211, 60, 75, 187, 203, 121, 38, 36, 69, 240, 170, 48, 3, 229, 50, 185, 154, 93, 190, 159, 121, 143,
				224, 240, 69, 194, 209, 142, 214, 204, 86, 120, 92, 19, 207, 86, 113, 219, 195, 5, 227, 95, 70, 138, 27, 169, 129, 172, 206, 180, 157, 241, 30, 143, 43, 84, 31, 72, 13, 18, 126, 124,
				240, 55, 24, 28, 12, 70, 238, 43, 98, 120, 3, 165, 27, 32, 29, 223, 109, 65, 65, 225, 64, 140, 239, 109, 90, 167, 40, 200, 246, 169, 222, 161, 26, 0, 4, 148, 188, 85, 206, 83, 160, 112,
				104, 122, 251, 129, 24, 47, 19, 237, 101, 85, 4, 137, 141, 15, 177, 2, 165, 124, 154, 9, 43, 188, 239, 71, 194, 127, 253, 71, 194, 158, 17, 235, 109, 193, 21, 137, 52, 155, 78, 71, 251,
				219, 112, 253, 220, 234, 229, 188, 225, 79, 216, 6, 89, 186, 83, 255, 86, 118, 136, 143, 222, 228, 113, 167, 190, 72, 33, 11, 47, 111, 195, 253, 187, 234, 88, 36, 140, 147, 245, 0, 29,
				155, 249, 120, 31, 175, 50, 251, 45, 22, 100, 126, 170, 151, 7, 30, 175, 251, 210, 172, 195, 203, 161, 82, 119, 74, 144, 238, 31, 192, 171, 74, 196, 230, 19, 122, 217, 207, 164, 119,
				111, 233, 20, 198, 40, 229, 13, 28, 64, 145, 127, 8, 57, 182, 145, 146, 49, 131, 244, 95, 33, 242, 140, 100, 179, 225, 219, 11, 168, 120, 99, 125, 137, 58, 208, 162, 181, 14, 235, 175,
				82, 184, 170, 47, 66, 37, 133, 0, 253, 195, 176, 33, 102, 205, 191, 123, 249, 230, 11, 90, 74, 223, 154, 190, 15, 159, 66, 29, 72, 209, 136, 52, 95, 76, 22, 81, 134, 24, 60, 48, 186,
				230, 142, 231, 153, 193, 35, 51, 241, 22, 249, 245, 12, 34, 219, 129, 194, 160, 195, 25, 153, 232, 252, 31, 194, 4, 134, 47, 210, 164, 236, 125, 204, 171, 33, 40, 93, 246, 13, 121, 200,
				167, 89, 122, 240, 44, 59, 143, 247, 47, 61, 102, 131, 71, 74, 212, 123, 117, 99, 46, 141, 145, 218, 109, 154, 208, 227, 172, 162, 174, 161, 225, 116, 234, 178, 253, 169, 195, 206, 45,
				212, 233, 67, 174, 104, 228, 51, 106, 199, 213, 138, 6, 7, 152, 81, 113, 104, 250, 57, 89, 188, 60, 72, 227, 184, 248, 196, 205, 94, 82, 96, 21, 250, 112, 58, 185, 120, 115, 177, 232,
				154, 243, 180, 165, 231, 27, 166, 231, 98, 126, 49, 124, 72, 215, 29, 58, 18, 242, 71, 39, 85, 104, 254, 19, 64, 137, 232, 70, 251, 116, 24, 85, 109, 67, 29, 210, 128, 217, 202, 231,
				88, 123, 59, 234, 198, 82, 26, 235, 124, 207, 221, 182, 245, 14, 98, 189, 195, 88, 235, 158, 90, 191, 29, 94, 125, 194, 60, 236, 198, 132, 216, 2, 143, 250, 161, 2, 189, 33, 5, 168,
				190, 70, 146, 0, 97, 146, 46, 147, 6, 141, 51, 92, 82, 63, 238, 20, 47, 30, 175, 180, 248, 90, 73, 55, 76, 74, 38, 12, 31, 77, 165, 130, 186, 115, 133, 181, 31, 201, 214, 15, 22, 77,
				182, 214, 194, 250, 156, 221, 121, 41, 174, 27, 185, 76, 126, 247, 137, 244, 53, 56, 89, 10, 108, 164, 175, 105, 24, 186, 81, 173, 117, 208, 136, 9, 89, 150, 84, 39, 237, 2, 254, 137,
				82, 111, 222, 8, 241, 231, 225, 244, 154, 243, 12, 133, 136, 179, 54, 127, 197, 235, 230, 237, 42, 124, 191, 250, 214, 162, 123, 251, 64, 83, 222, 178, 91, 154, 224, 247, 88, 115, 253,
				235, 61, 236, 105, 132, 155, 120, 24, 252, 102, 243, 240, 115, 149, 165, 39, 24, 143, 24, 201, 252, 63, 68, 175, 9, 11, 235, 187, 0, 219, 97, 101, 233, 56, 79, 218, 14, 127, 178, 249,
				63, 80, 75, 7, 8, 145, 75, 73, 23, 109, 3, 0, 0, 168, 7, 0, 0, 80, 75, 3, 4, 20, 0, 8, 8, 8, 0, 125, 60, 7, 79, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 13, 0, 0, 0, 120, 108, 47, 115, 116,
				121, 108, 101, 115, 46, 120, 109, 108, 237, 88, 93, 111, 155, 48, 20, 125, 223, 175, 176, 252, 190, 2, 105, 146, 182, 19, 208, 117, 157, 50, 237, 101, 170, 214, 84, 154, 52, 237, 193,
				5, 3, 86, 253, 129, 108, 167, 13, 253, 245, 179, 49, 16, 104, 210, 77, 75, 43, 45, 149, 120, 178, 239, 245, 61, 247, 30, 142, 185, 137, 113, 120, 190, 102, 20, 220, 99, 169, 136, 224,
				17, 12, 142, 124, 8, 48, 79, 68, 74, 120, 30, 193, 155, 229, 226, 253, 41, 4, 74, 35, 158, 34, 42, 56, 142, 96, 133, 21, 60, 143, 223, 133, 74, 87, 20, 95, 23, 24, 107, 96, 50, 112, 21,
				193, 66, 235, 242, 131, 231, 169, 164, 192, 12, 169, 35, 81, 98, 110, 86, 50, 33, 25, 210, 198, 148, 185, 167, 74, 137, 81, 170, 44, 136, 81, 111, 226, 251, 115, 143, 33, 194, 97, 28,
				242, 21, 91, 48, 173, 64, 34, 86, 92, 71, 112, 210, 185, 128, 27, 190, 166, 134, 219, 124, 10, 129, 75, 119, 41, 82, 67, 229, 11, 230, 88, 34, 10, 189, 157, 193, 179, 97, 240, 71, 27,
				230, 53, 117, 226, 48, 19, 124, 83, 110, 6, 157, 35, 14, 213, 35, 184, 71, 212, 192, 253, 58, 43, 98, 216, 217, 23, 146, 184, 66, 25, 98, 132, 86, 206, 57, 177, 142, 164, 64, 82, 25,
				17, 28, 172, 46, 226, 82, 237, 145, 208, 63, 48, 248, 173, 91, 208, 114, 133, 237, 218, 43, 138, 83, 15, 118, 27, 8, 165, 131, 93, 183, 142, 56, 44, 145, 214, 88, 242, 133, 49, 64, 51,
				95, 86, 165, 217, 69, 110, 222, 65, 151, 166, 142, 251, 75, 116, 46, 81, 21, 76, 102, 61, 64, 61, 152, 186, 183, 66, 166, 230, 157, 111, 43, 7, 176, 117, 129, 148, 160, 92, 112, 68,
				111, 202, 8, 102, 136, 42, 12, 59, 215, 103, 241, 192, 91, 103, 28, 82, 156, 105, 147, 88, 146, 188, 176, 163, 22, 165, 103, 147, 104, 45, 152, 153, 180, 24, 91, 218, 101, 238, 38, 166,
				124, 130, 41, 189, 182, 13, 244, 35, 219, 60, 189, 111, 146, 174, 179, 237, 23, 158, 215, 134, 233, 75, 203, 189, 153, 186, 76, 141, 129, 202, 146, 86, 11, 97, 147, 212, 91, 229, 28,
				159, 234, 144, 129, 235, 130, 146, 156, 51, 252, 36, 240, 74, 10, 141, 19, 93, 247, 127, 237, 142, 67, 212, 6, 130, 66, 72, 242, 104, 82, 219, 13, 204, 155, 126, 179, 63, 23, 154, 36,
				214, 229, 158, 23, 2, 141, 215, 250, 187, 208, 200, 101, 49, 156, 30, 36, 42, 151, 198, 217, 137, 72, 120, 90, 23, 54, 107, 170, 144, 132, 223, 45, 197, 130, 116, 203, 70, 166, 178,
				163, 1, 168, 72, 238, 112, 218, 146, 44, 72, 106, 160, 189, 72, 111, 157, 61, 81, 202, 223, 232, 20, 236, 171, 83, 195, 243, 169, 80, 125, 119, 95, 169, 246, 53, 120, 59, 100, 38, 35,
				153, 103, 200, 236, 221, 91, 35, 153, 145, 204, 72, 102, 36, 51, 146, 217, 135, 204, 244, 248, 144, 254, 41, 167, 193, 65, 177, 153, 30, 20, 155, 201, 33, 177, 57, 251, 207, 100, 188,
				254, 241, 221, 29, 230, 123, 231, 248, 227, 125, 143, 241, 235, 108, 155, 121, 159, 207, 11, 169, 191, 181, 51, 125, 243, 5, 63, 202, 246, 2, 217, 166, 255, 38, 219, 235, 245, 201,
				27, 80, 205, 107, 250, 182, 247, 53, 222, 245, 240, 28, 246, 188, 192, 222, 116, 68, 240, 155, 189, 76, 162, 61, 225, 110, 87, 132, 106, 194, 157, 229, 109, 3, 46, 5, 99, 168, 141,
				15, 102, 3, 192, 241, 179, 0, 240, 211, 255, 213, 129, 230, 3, 208, 124, 39, 104, 37, 37, 230, 73, 213, 97, 78, 6, 152, 233, 159, 48, 131, 90, 167, 3, 220, 201, 46, 220, 21, 150, 137,
				217, 131, 14, 114, 54, 128, 184, 123, 150, 141, 152, 198, 216, 92, 18, 198, 191, 1, 80, 75, 7, 8, 183, 119, 49, 208, 178, 2, 0, 0, 105, 20, 0, 0, 80, 75, 3, 4, 20, 0, 8, 8, 8, 0, 125,
				60, 7, 79, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 15, 0, 0, 0, 120, 108, 47, 119, 111, 114, 107, 98, 111, 111, 107, 46, 120, 109, 108, 141, 83, 201, 110, 219, 48, 16, 189, 247, 43, 4,
				222, 109, 45, 94, 106, 27, 150, 3, 87, 142, 144, 0, 221, 16, 167, 201, 153, 146, 70, 22, 107, 138, 20, 200, 241, 150, 162, 255, 222, 17, 101, 165, 41, 218, 67, 15, 54, 57, 11, 223,
				188, 153, 121, 90, 222, 156, 107, 233, 29, 193, 88, 161, 85, 204, 194, 97, 192, 60, 80, 185, 46, 132, 218, 197, 236, 219, 99, 58, 152, 49, 207, 34, 87, 5, 151, 90, 65, 204, 46, 96,
				217, 205, 234, 221, 242, 164, 205, 62, 211, 122, 239, 209, 123, 101, 99, 86, 33, 54, 11, 223, 183, 121, 5, 53, 183, 67, 221, 128, 162, 72, 169, 77, 205, 145, 76, 179, 243, 109, 99,
				128, 23, 182, 2, 192, 90, 250, 81, 16, 76, 253, 154, 11, 197, 58, 132, 133, 249, 31, 12, 93, 150, 34, 135, 141, 206, 15, 53, 40, 236, 64, 12, 72, 142, 196, 222, 86, 162, 177, 108,
				181, 44, 133, 132, 167, 174, 33, 143, 55, 205, 103, 94, 19, 237, 132, 203, 156, 249, 171, 87, 218, 95, 141, 151, 241, 124, 127, 104, 82, 202, 142, 89, 201, 165, 5, 106, 180, 210, 167,
				47, 217, 119, 200, 145, 58, 226, 82, 50, 175, 224, 8, 225, 60, 24, 247, 41, 127, 64, 104, 164, 76, 42, 67, 206, 214, 241, 36, 224, 100, 127, 199, 91, 211, 33, 222, 105, 35, 94, 180,
				66, 46, 183, 185, 209, 82, 198, 12, 205, 225, 90, 141, 136, 162, 200, 255, 21, 217, 182, 131, 122, 228, 153, 237, 157, 231, 103, 161, 10, 125, 138, 25, 173, 232, 242, 230, 126, 114,
				215, 103, 81, 96, 69, 11, 156, 142, 102, 227, 222, 119, 7, 98, 87, 97, 204, 102, 225, 60, 98, 30, 242, 236, 161, 29, 84, 204, 38, 1, 61, 43, 133, 177, 232, 138, 56, 20, 78, 157, 28,
				129, 234, 181, 22, 53, 228, 191, 233, 200, 237, 172, 63, 61, 229, 6, 234, 94, 134, 45, 85, 58, 239, 11, 170, 236, 116, 130, 20, 58, 10, 43, 50, 73, 140, 205, 66, 80, 192, 220, 23,
				145, 67, 236, 97, 168, 221, 156, 230, 47, 16, 12, 229, 39, 250, 160, 136, 66, 216, 114, 50, 80, 126, 210, 5, 65, 172, 9, 237, 26, 127, 93, 206, 213, 222, 128, 68, 78, 36, 135, 65, 16,
				182, 176, 112, 198, 143, 22, 221, 121, 85, 146, 212, 116, 255, 75, 77, 82, 100, 6, 58, 253, 56, 41, 49, 239, 96, 68, 204, 126, 188, 159, 70, 211, 100, 54, 141, 6, 209, 58, 28, 13, 194,
				240, 118, 50, 248, 48, 26, 79, 6, 233, 109, 154, 210, 224, 146, 77, 50, 79, 127, 146, 172, 28, 234, 130, 126, 73, 71, 223, 162, 161, 111, 228, 1, 202, 237, 133, 86, 123, 238, 36,
				182, 118, 148, 124, 202, 234, 254, 29, 51, 191, 87, 196, 234, 23, 80, 75, 7, 8, 139, 120, 51, 237, 247, 1, 0, 0, 110, 3, 0, 0, 80, 75, 3, 4, 20, 0, 8, 8, 8, 0, 125, 60, 7, 79, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 20, 0, 0, 0, 120, 108, 47, 115, 104, 97, 114, 101, 100, 83, 116, 114, 105, 110, 103, 115, 46, 120, 109, 108, 125, 142, 77, 10, 194, 48, 16, 133, 247,
				158, 34, 204, 222, 166, 118, 33, 82, 146, 116, 161, 8, 238, 245, 0, 161, 29, 109, 160, 153, 196, 76, 90, 244, 246, 70, 65, 220, 185, 124, 188, 239, 253, 168, 238, 225, 39, 177, 96,
				98, 23, 72, 195, 166, 170, 65, 32, 245, 97, 112, 116, 211, 112, 57, 31, 215, 59, 16, 156, 45, 13, 118, 10, 132, 26, 158, 200, 208, 153, 149, 98, 206, 162, 68, 137, 53, 140, 57, 199,
				86, 74, 238, 71, 244, 150, 171, 16, 145, 138, 115, 13, 201, 219, 92, 100, 186, 73, 142, 9, 237, 192, 35, 98, 246, 147, 108, 234, 122, 43, 189, 117, 4, 162, 15, 51, 101, 13, 13, 136,
				153, 220, 125, 198, 253, 87, 27, 197, 206, 168, 207, 68, 203, 209, 246, 101, 185, 116, 48, 166, 5, 193, 156, 14, 74, 102, 163, 228, 27, 249, 131, 33, 253, 48, 89, 254, 154, 23, 80,
				75, 7, 8, 117, 146, 123, 210, 166, 0, 0, 0, 237, 0, 0, 0, 80, 75, 3, 4, 20, 0, 8, 8, 8, 0, 125, 60, 7, 79, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 26, 0, 0, 0, 120, 108, 47, 95, 114, 101,
				108, 115, 47, 119, 111, 114, 107, 98, 111, 111, 107, 46, 120, 109, 108, 46, 114, 101, 108, 115, 173, 145, 77, 107, 195, 48, 12, 134, 239, 253, 21, 70, 247, 197, 73, 7, 99, 140, 56,
				189, 140, 65, 175, 253, 248, 1, 198, 81, 226, 208, 196, 54, 146, 214, 181, 255, 126, 46, 27, 91, 10, 101, 236, 208, 147, 208, 215, 243, 190, 72, 245, 234, 52, 141, 234, 136, 196, 67,
				12, 6, 170, 162, 4, 133, 193, 197, 118, 8, 189, 129, 253, 238, 237, 225, 25, 86, 205, 162, 222, 224, 104, 37, 143, 176, 31, 18, 171, 188, 19, 216, 128, 23, 73, 47, 90, 179, 243, 56,
				89, 46, 98, 194, 144, 59, 93, 164, 201, 74, 78, 169, 215, 201, 186, 131, 237, 81, 47, 203, 242, 73, 211, 156, 1, 205, 21, 83, 173, 91, 3, 180, 110, 43, 80, 187, 115, 194, 255, 176, 99,
				215, 13, 14, 95, 163, 123, 159, 48, 200, 13, 9, 205, 114, 30, 145, 51, 209, 82, 143, 98, 224, 43, 47, 50, 7, 244, 109, 249, 229, 61, 229, 63, 34, 29, 216, 35, 202, 175, 131, 159, 82,
				54, 119, 9, 213, 95, 102, 30, 239, 122, 11, 111, 9, 219, 173, 80, 126, 236, 252, 36, 243, 242, 183, 153, 69, 173, 175, 222, 221, 124, 2, 80, 75, 7, 8, 79, 240, 249, 122, 210, 0, 0, 0,
				37, 2, 0, 0, 80, 75, 3, 4, 20, 0, 8, 8, 8, 0, 125, 60, 7, 79, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 19, 0, 0, 0, 91, 67, 111, 110, 116, 101, 110, 116, 95, 84, 121, 112, 101, 115, 93, 46,
				120, 109, 108, 173, 84, 201, 78, 195, 48, 16, 189, 247, 43, 34, 95, 81, 236, 150, 3, 66, 40, 105, 15, 44, 71, 168, 68, 57, 35, 99, 79, 18, 211, 120, 145, 237, 150, 246, 239, 25, 39, 8,
				85, 40, 180, 69, 228, 100, 217, 51, 111, 153, 103, 217, 197, 98, 167, 219, 108, 11, 62, 40, 107, 74, 50, 163, 83, 146, 129, 17, 86, 42, 83, 151, 228, 101, 245, 144, 95, 147, 197, 124,
				82, 172, 246, 14, 66, 134, 189, 38, 148, 164, 137, 209, 221, 48, 22, 68, 3, 154, 7, 106, 29, 24, 172, 84, 214, 107, 30, 113, 235, 107, 230, 184, 88, 243, 26, 216, 229, 116, 122, 197,
				132, 53, 17, 76, 204, 99, 226, 32, 243, 226, 14, 42, 190, 105, 99, 118, 191, 195, 227, 94, 23, 225, 36, 187, 237, 251, 146, 84, 73, 184, 115, 173, 18, 60, 98, 153, 165, 42, 27, 196,
				121, 104, 195, 17, 224, 214, 200, 31, 238, 242, 47, 103, 20, 145, 93, 79, 104, 148, 11, 23, 191, 43, 56, 83, 255, 16, 80, 58, 77, 150, 206, 135, 17, 239, 14, 134, 33, 93, 1, 49, 79,
				24, 183, 87, 18, 178, 37, 247, 241, 145, 107, 108, 96, 175, 105, 18, 70, 71, 158, 103, 72, 73, 90, 177, 244, 214, 5, 188, 22, 15, 244, 120, 240, 71, 244, 18, 58, 119, 72, 4, 62, 42, 56,
				79, 17, 169, 255, 46, 104, 171, 74, 9, 64, 142, 141, 70, 8, 133, 20, 180, 4, 121, 166, 246, 174, 101, 31, 214, 175, 67, 3, 16, 3, 235, 150, 217, 191, 61, 4, 231, 129, 203, 142, 76, 183,
				244, 155, 255, 132, 143, 16, 247, 45, 132, 145, 197, 123, 210, 51, 18, 120, 179, 118, 61, 182, 118, 90, 169, 230, 202, 156, 154, 188, 225, 30, 228, 115, 244, 248, 169, 140, 30, 192, 33,
				247, 9, 31, 253, 35, 59, 76, 99, 228, 7, 55, 41, 88, 247, 81, 206, 63, 1, 80, 75, 7, 8, 252, 211, 131, 118, 85, 1, 0, 0, 87, 5, 0, 0, 80, 75, 1, 2, 20, 0, 20, 0, 8, 8, 8, 0, 125, 60, 7,
				79, 102, 170, 130, 183, 224, 0, 0, 0, 59, 2, 0, 0, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 95, 114, 101, 108, 115, 47, 46, 114, 101, 108, 115, 80, 75, 1, 2, 20, 0, 20, 0,
				8, 8, 8, 0, 125, 60, 7, 79, 251, 89, 193, 235, 120, 1, 0, 0, 3, 3, 0, 0, 17, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 25, 1, 0, 0, 100, 111, 99, 80, 114, 111, 112, 115, 47, 99, 111, 114,
				101, 46, 120, 109, 108, 80, 75, 1, 2, 20, 0, 20, 0, 8, 8, 8, 0, 125, 60, 7, 79, 252, 113, 90, 30, 2, 1, 0, 0, 154, 1, 0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 208, 2, 0, 0, 100,
				111, 99, 80, 114, 111, 112, 115, 47, 97, 112, 112, 46, 120, 109, 108, 80, 75, 1, 2, 20, 0, 20, 0, 8, 8, 8, 0, 125, 60, 7, 79, 145, 75, 73, 23, 109, 3, 0, 0, 168, 7, 0, 0, 24, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 16, 4, 0, 0, 120, 108, 47, 119, 111, 114, 107, 115, 104, 101, 101, 116, 115, 47, 115, 104, 101, 101, 116, 49, 46, 120, 109, 108, 80, 75, 1, 2, 20, 0, 20,
				0, 8, 8, 8, 0, 125, 60, 7, 79, 183, 119, 49, 208, 178, 2, 0, 0, 105, 20, 0, 0, 13, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 195, 7, 0, 0, 120, 108, 47, 115, 116, 121, 108, 101, 115, 46,
				120, 109, 108, 80, 75, 1, 2, 20, 0, 20, 0, 8, 8, 8, 0, 125, 60, 7, 79, 139, 120, 51, 237, 247, 1, 0, 0, 110, 3, 0, 0, 15, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 176, 10, 0, 0, 120, 108,
				47, 119, 111, 114, 107, 98, 111, 111, 107, 46, 120, 109, 108, 80, 75, 1, 2, 20, 0, 20, 0, 8, 8, 8, 0, 125, 60, 7, 79, 117, 146, 123, 210, 166, 0, 0, 0, 237, 0, 0, 0, 20, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 0, 0, 0, 0, 228, 12, 0, 0, 120, 108, 47, 115, 104, 97, 114, 101, 100, 83, 116, 114, 105, 110, 103, 115, 46, 120, 109, 108, 80, 75, 1, 2, 20, 0, 20, 0, 8, 8, 8, 0, 125, 60,
				7, 79, 79, 240, 249, 122, 210, 0, 0, 0, 37, 2, 0, 0, 26, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 204, 13, 0, 0, 120, 108, 47, 95, 114, 101, 108, 115, 47, 119, 111, 114, 107, 98, 111,
				111, 107, 46, 120, 109, 108, 46, 114, 101, 108, 115, 80, 75, 1, 2, 20, 0, 20, 0, 8, 8, 8, 0, 125, 60, 7, 79, 252, 211, 131, 118, 85, 1, 0, 0, 87, 5, 0, 0, 19, 0, 0, 0, 0, 0, 0, 0, 0, 0,
				0, 0, 0, 0, 230, 14, 0, 0, 91, 67, 111, 110, 116, 101, 110, 116, 95, 84, 121, 112, 101, 115, 93, 46, 120, 109, 108, 80, 75, 5, 6, 0, 0, 0, 0, 9, 0, 9, 0, 63, 2, 0, 0, 124, 16, 0, 0, 0, 0
			});
		}

		#endregion

		#region Editor Members

		public virtual void OnEnable() {
			this.m_defaultLanguage = this.serializedObject.FindProperty(@"m_defaultLanguage");
			this.m_onChangeLanguage = this.serializedObject.FindProperty(@"m_onChangeLanguage");
		}

		public override void OnInspectorGUI() {
			serializedObject.Update();

			EditorGUILayout.PropertyField(this.m_defaultLanguage);
			EditorGUILayout.PropertyField(m_onChangeLanguage);

			EditorGUILayout.Space();

			if (GUILayout.Button(new GUIContent(@"Create Localization Sheet"))) {
				this.CreateLocalizationSheet();
			}

			if (GUILayout.Button(new GUIContent(@"Edit Localization Sheet"))) {
				this.EditLocalizationSheet();
			}

			if (GUILayout.Button(new GUIContent(@"Generate Localization Data"))) {
				this.GenerateLocalizationData(this.target as LocalizationManager);
			}

			serializedObject.ApplyModifiedProperties();
		}

		#endregion
	}
}